# Scalabe ML with Spark

## Learning Objectives

Spark MLlib is Spark's scalable machine learning module. It provides a collection of distributed machine learning algorithms and utilities. It is a popular scalable ML framework. 

In this section, you will learn:

- Introduction to Spark MLlib
- Compare Scalable ML Frameworks
- MLlib Data types and file formats
- Transformer, Estimator, and Pipeline
- MLlib Feature engineering APIs
- Evaluation & Hyper Parameter Tuning
- Algorithms in MLlib

**[slides](Spark7-SparkMLLib.pdf) / [print version](Spark7-SparkMLLib-Print.pdf)**

## Class 1

Watch the following clips on this topic, then complete the **self-assessment 18** below.

**SparkML Part 1 Intro to MLlib (17:48)**

<iframe width="560" height="315" src="https://www.youtube.com/embed/1kud_rAd978" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>

**SparkML Part 2 MLlib Data Frame Preparation (16:09)**

<iframe width="560" height="315" src="https://www.youtube.com/embed/JWKmScqnk3Q" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>

**SparkML Part 3 Transformer, Estimator, and Pipeline (16:39)**

<iframe width="560" height="315" src="https://www.youtube.com/embed/GGYssoWT5GE" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>

**SparkML Part 4 Overview of Feature Engineering APIs (12:53)**

<iframe width="560" height="315" src="https://www.youtube.com/embed/MMoBHJFXJVY" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>


- Complete **self-assessment 17** based on the materials in the above

### In-Class

- Complete [Spark Lab 7:Using Spark MLlib for Feature Engineering and Prediction ](sparklab07-MLlib/README.md)


## Class 2

### Pre-work

Watch the following clips on this topic, then complete the **self-assessment 19** below.

**SparkML Part 5 Evaluation and Hyper Parameter Tunning (13:54)**

<iframe width="560" height="315" src="https://www.youtube.com/embed/eF6z6HdyeaM" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>

### In-class

- Complete [Spark Lab 8:Predict bike sharing Using MLlib's pipeline and Gradient-Boosted Trees](sparklab08-MLlib2/README.md)

## Class 3

### Pre-work

TBA

### In-Class

TBA

## Assignments

- Complete [**Homework Assignment 7**](../homeworks/hw6/hw6.md)

## Resources

### Offical Examples - A relative comprehensive set of (but simple) examples
- [PySpark MLlib examples (RDD-based APIs)](https://github.com/apache/spark/tree/master/examples/src/main/python/mllib) 
- [PySpark ML Examples (DataFrame APIS)](https://github.com/apache/spark/tree/master/examples/src/main/python/ml) 
- [Scala MLlib/ML Examples](https://github.com/apache/spark/tree/master/examples/src/main/scala/org/apache/spark/examples) 

### API documentation
- [Spark MLlib Guide (latest)](http://spark.apache.org/docs/latest/ml-guide.html)
- [Spark MLlib Python API Docs (for latest Spark), navigate to pyspark.mllib](https://spark.apache.org/docs/latest/api/python/index.html)


### MLlib Code Examples (many of these are still RDD-based APIs) 
- [DataBricks MLlib examples](https://docs.databricks.com/spark/latest/mllib/index.html)  
- [Spark & Python: MLlib Decision Trees](https://www.codementor.io/spark/tutorial/spark-python-mllib-decision-trees)
- [Spark MLlib Linear Regression: Population vs. Median Home Prices](https://cdn2.hubspot.net/hubfs/438089/notebooks/Pop._vs._Price_LR.html)
- [Apache® Spark™ MLlib: From Quick Start to Scikit-Learn (2016)](http://www.slideshare.net/databricks/spark-mllib-from-quick-start-to-scikitlearn)
- [Spark MLlib - Training Material (Bryan Yang, 2015)](http://www.slideshare.net/liweiyang5/spark-mllib-training-material?qid=4c99d089-1442-4f83-9243-c0345794ecc1&v=&b=&from_search=12)

### Deep Learning with Spark

The following gives you some introduction on how you can leverage Spark for deep learning.

- [Apache Spark gets a machine learning makeover](https://blog.fastforwardlabs.com/2018/09/28/apache-spark-gets-a-machine-learning-makeover.html)

- [Deep Learning with Spark](https://www.kdnuggets.com/2018/05/deep-learning-apache-spark-part-2.html)

- [Towards Data Science's Deep Learning With Apache Spark — Part 1](https://towardsdatascience.com/deep-learning-with-apache-spark-part-1-6d397c16abd)

- [DataBrick's Deep Learning Pipelines for Apache Spark](https://github.com/databricks/spark-deep-learning)